---
title: "EDS 223 Homework 2"
author: Ava Robillard
date: October 11, 2025
format: html
execute:
  message: false
  warning: false
---

## Exploring patterns of environmental justice in Los Angeles, California

During the 1930's, the Home Owner's Loan Corporation (HOLC) rated neighborhoods based upon their perceived safety ratings, eventually used blocking for access to loans for home ownership. Known as redlining, this practice has had persistent effects in the present-day, from the health of the surrounding environment to community involvement in citizen science. This makes mapping this data important for making informed decisions about conservation efforts and ensuring that all people have equitable access to a safe and biodiverse environment.

**Objective**: Use EJScreen, HOLC designations, and bird observation data to visualize the effects of redlining on present-day Los Angeles, California as studied in [Ellis-Soto et al. 2023](https://ecoevorxiv.org/repository/view/3736/).

### Load packages
```{r}
library(tidyverse)
library(sf)
library(tmap)
library(kableExtra)
```

### Import data
1. Import the EJScreen, HOLC designation, and bird observation data, filter to Los Angeles, and ensure they have the same coordinate reference system
```{r}
# Read in data
ejscreen <- read_sf(here::here("data", "ejscreen", "EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb")) 
  
holc <- read_sf(here::here("data", "mapping-inequality", "mapping-inequality-los-angeles.json"))

bird_obs <- read_sf(here::here("data", "gbif-birds-LA", "gbif-birds-LA.shp"))
```

```{r}
# Filter EJScreen data to California
ejscreen_ca <- ejscreen %>%
  dplyr::filter(ST_ABBREV == "CA") 

# Filter to Los Angeles County only
ejscreen_la <- ejscreen_ca %>%
  filter(CNTY_NAME %in% c("Los Angeles County")) 
```

```{r}
# Check the CRS of each dataset
st_crs(ejscreen_la)
st_crs(holc)
st_crs(bird_obs)

# Transform the CRS of the  dataset
holc <- st_transform(holc, crs = st_crs(ejscreen_la))
bird_obs <- st_transform(bird_obs, crs = st_crs(ejscreen_la))

# Ensure that the CRS matches between all three datasets
if((st_crs(ejscreen_la) == st_crs(holc)) & (st_crs(holc) == st_crs(bird_obs))){
  print("It's a match!")
} else {
  print("Not a match")
}
```

## Part 1: Legacy of redlining in current enviornmental (in)justice
Explore historical redlining in Los Angeles and its legacy on present-day environmental justice

### Visualize data
2. Create a map of historical redlining neighborhoods colored by HOLC grade
```{r}
# Use HOLC dataset to create map
tm_shape(ejscreen_la, bbox = holc) +
  tm_polygons() +
tm_shape(holc) +
  tm_fill(fill = "grade",
          fill.scale = tm_scale(values = c("#76a865", "#7cb5bd", "#DAA520", "#d9838d")),
          fill.legend = tm_legend(title = "HOLC grade")) +
  tm_title(text = "HOLC Grades of Los Angeles Neighborhoods") +
  tm_basemap("CartoDB.Positron") +
  tm_layout(legend.text.size = 0.7,
            frame.double_line = TRUE) +
  tm_compass(type = "8star", size = 2) +
  tm_scalebar() 
```

Create a table with the percentages of census blocks falling within each HOLC grade 
```{r}
# Spatially join EJScreen and HOLC data
census_grades <- st_join(ejscreen_la, holc) %>% 
  st_drop_geometry()

# Create table of HOLC grade percentages
census_grades %>% 
  group_by(grade) %>% 
  summarize(percentage = (n())/100) %>% 
  kbl(caption = "Percentage of Census Block Groups in each HOLC Grade") %>% 
  kable_styling()
```
 

