---
title: "EDS 223 Homework 2"
author: Ava Robillard
date: October 18, 2025
format: html
execute:
  message: false
  warning: false
---

## Exploring patterns of environmental justice in Los Angeles, California

During the 1930's, the Home Owner's Loan Corporation (HOLC) rated neighborhoods based upon their perceived safety ratings, which was then used for blocking access to loans for home ownership. Known as redlining, this practice has had persistent effects in the present-day, from the health of the surrounding environment to community involvement in citizen science. This makes mapping this data important for making informed decisions about conservation efforts and ensuring that all people have equitable access to a safe and biodiverse environment.

**Objective**: Use EJScreen, HOLC designations, and bird observation data to visualize the effects of redlining on present-day Los Angeles, California as studied in [Ellis-Soto et al. 2023](https://ecoevorxiv.org/repository/view/3736/).

### Load packages
```{r}
library(tidyverse)
library(sf)
library(tmap)
library(kableExtra)
library(patchwork)
```

### Import data
Import the EJScreen, HOLC designation, and bird observation data
```{r}
# Read in data
ejscreen <- read_sf(here::here("data", "ejscreen", "EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb")) 
  
holc <- read_sf(here::here("data", "mapping-inequality", "mapping-inequality-los-angeles.json"))

bird_obs <- read_sf(here::here("data", "gbif-birds-LA", "gbif-birds-LA.shp"))
```

Filter the EJScreen data to only Los Angeles County, California
```{r}
# Filter EJScreen data to California
ejscreen_ca <- ejscreen %>%
  dplyr::filter(ST_ABBREV == "CA") 

# Filter to Los Angeles County only
ejscreen_la <- ejscreen_ca %>%
  filter(CNTY_NAME %in% c("Los Angeles County")) 
```

The CRS of each data set was checked using st_crs(), and it was determined that only the EJScreen data was using the EPSG 3857 projected coordinate system while the HOLC and bird observation data were using the EPSG 4326 geographic coordinate system.
```{r}
# Transform the CRS of the data set
holc <- st_transform(holc, crs = st_crs(ejscreen_la))
bird_obs <- st_transform(bird_obs, crs = st_crs(ejscreen_la))

# Ensure that the CRS matches between all three data sets
if((st_crs(ejscreen_la) == st_crs(holc)) & (st_crs(holc) == st_crs(bird_obs))){
  print("It's a match!")
} else {
  print("Not a match")
}
```

## Part 1: Legacy of redlining in current enviornmental (in)justice
Explore historical redlining in Los Angeles and its legacy on present-day environmental justice

### Visualize data
1. Create a map of historical redlining neighborhoods colored by HOLC grade
```{r}
# Use HOLC dataset to create map
tm_shape(holc) +
  tm_fill(fill = "grade",
          fill.scale = tm_scale(values = c("#76a865", "#7cb5bd", "#DAA520", "#d9838d")),
          fill.legend = tm_legend(title = "HOLC grade")) +
  tm_borders(lwd = 0.7) +
  tm_title(text = "HOLC Grades of Los Angeles Neighborhoods") +
  tm_basemap("CartoDB.Positron") +
  tm_layout(legend.text.size = 0.7,
            frame.double_line = TRUE) +
  tm_compass(type = "8star", size = 2) +
  tm_scalebar() 
```

2. Spatially join EJScreen and HOLC data in order to create a table with the percentages of census blocks falling within each HOLC grade 
```{r}
# Spatially join EJScreen and HOLC data
census_grades <- st_join(ejscreen_la, holc) %>% 
  st_drop_geometry()

# Create table of HOLC grade percentages
census_grades %>% 
  group_by(grade) %>% 
  summarize(percentage = (n())/100) %>% 
  kbl(caption = "Percentage of Census Block Groups in each HOLC Grade") %>% 
  kable_styling()
```
 

3. Create visualizations summarizing current conditions from the EJScreen data 
within HOLC grades
```{r}
# Group by HOLC grade and calculate mean for each environmental variable 
grade_means <- census_grades %>% 
  group_by(grade) %>% 
  summarize(lowinc_pct = mean(LOWINCPCT, na.rm = TRUE),
            pm25_pctl = mean(P_D2_PM25, na.rm = TRUE),
            lifeexp_pctl = mean(P_LIFEEXPPCT, na.rm = TRUE),
            hazwaste_pctl = mean(P_PTSDF, na.rm = TRUE)) 

# Pivot longer to create structure for plotting
grades_means_long <- grade_means %>% 
  pivot_longer(lowinc_pct:hazwaste_pctl,
               names_to = "variable",
               values_to = "mean")

# Plot variables and facet wrap
env_plot <- ggplot(grades_means_long, aes(grade, mean, fill = grade)) +
  geom_bar(stat = "identity") +
  labs(title = "Mean of Enviornmental Variables across HOLC Grades") +
  scale_fill_manual(values = 
  c("A" = "#76a865", "B" = "#7cb5bd", "C" = "#DAA520", "D" = "#d9838d")) +
  facet_wrap(vars(variable),
             scales = "free_y",
             labeller = labeller(variable = 
                                    c(lowinc_pct = "Low Income (%)",
                                      pm25_pctl = "PM 2.5 Percentile",
                                      lifeexp_pctl = "Life Expectancy Percentile",
                                      hazwaste_pctl = "Hazardous Waste Proximity Percentile"))) +
  theme_minimal()

env_plot
```

### Interpretation of results

Across all four bar graphs displaying the mean values of EJScreen variables, there is a clear trend of census block groups that received a HOLC grade designation of D having higher values for socioeconomic and environmental indicators than those that received a grade of A.

The EJScreen socioeconomic indicator data were sourced from the U.S. Census Bureau's American Community Survey (ACS) 2017-2021 5-Year-Estimates, while the environmental indicator data were gathered from a variety of sources spanning 2017 to 2023. The HOLC grades were established in the 1930s, so being able to visualize clear trends in environmental hazards and community susceptibility almost 100 years later shows the persistence of the effects of redlining. 

Based on where these grades were located in the map of Los Angeles neighborhoods, areas rated C and D appear to have remained more urban and therefore close to sources of environmental hazards such as waste or PM 2.5 over time. This may be due to the historical blocking of loans and investments for buying homes in these areas, preventing long-term ownership and care. Overall, the bar graphs reflect these disparities and show that redlining has contributed to long-term environmental justice issues in Los Angeles.


## Part 2: Legacy of redlining in biodiversity observations
Explore historical redlining in Los Angeles in the collection of bird observations

### Visualize data

1. Spatially join bird observation data to HOLC grade data to assign each bird observation to a corresponding HOLC grade
```{r}
# Spatially join bird observation and HOLC data
bird_grades <- st_join(holc, bird_obs) %>% 
  st_drop_geometry()
```

2. Create a visualization of the percentage of bird observations within each HOLC grade
```{r}
# Group by HOLC grade and calculate the percentage of total bird observations 
bird_percents <- bird_grades %>% 
  group_by(grade) %>% 
  summarize(pct_total = n()/nrow(bird_grades)*100)

# Create graph of percentages
bird_plot <- ggplot(bird_percents, aes(x = grade, y = pct_total, fill = grade)) +
  geom_bar(stat = "identity") +
  labs(y = "percent of total",
       title = "Percentage of Bird Observations in each HOLC Grade") +
  scale_fill_manual(values = c("A" = "#76a865", "B" = "#7cb5bd", "C" = "#DAA520", "D" = "#d9838d")) +
  theme_minimal()

bird_plot
```

### Interpretation of results

There is the largest proportion of bird observations in neighborhoods that were previously grade C areas, with grade A and B having the second largest proportions of observations.

These results did not match the findings from [Ellis-Soto et al. 2023](https://ecoevorxiv.org/repository/view/3736/), which is likely due to differences in sampling and study design. They covered 38 states and 195 metropolitan areas, creating a larger sample that is likely better at estimating the true differences between grades. They also took into account differences in vegetation, open space, and population density and included them as predictors in their model, which would reduce the confounding effects of these variables on the results. For instance, areas that were grade C could have the highest population density in Los Angeles, which would skew the results even if there was not a high sampling density in these areas.

## Data Citations 
---
[EJScreen](https://pedp-ejscreen.azurewebsites.net/). Accessed Oct 11, 2025

[Digital Scholarship Lab, Mapping Inequality project: HOLC redlining data](https://dsl.richmond.edu/panorama/redlining/data). Accessed Oct 11, 2025

[Global Biodiversity Information Facility: bird observation data](https://www.gbif.org/). Accessed Oct 11, 2025
